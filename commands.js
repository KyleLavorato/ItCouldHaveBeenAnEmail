!function(){var e,t={1792:function(e,t){t.salaryData={"Software Developer Co-Op":62400,"Software Developer":69100,"Sr. Software Developer":86700,"Staff Software Developer":100900,"Sr. Staff Software Developer":121800,"Y Leader":142800,"Y Coach":18e4,Default:86700}}},o={},n=function e(n){var s=o[n];if(void 0!==s)return s.exports;var a=o[n]={exports:{}};return t[n](a,a.exports,e),a.exports}(1792).salaryData;function s(t){e.body.getAsync("html",{asyncContext:t},(function(t){var o,s,a;e.itemType===Office.MailboxEnums.ItemType.Appointment&&(o=function(o){var s,a;console.log("Meeting duration: "+o+" hours"),s=function(e){var s,a;e?(s=e,a=function(e){if(t.status===Office.AsyncResultStatus.Succeeded){var s=function(e,t){var o=0;return e.forEach((function(e){console.log("Email: ".concat(e.email,", Job Title: ").concat(e.jobTitle)),console.log(n),console.log("Salary: ".concat(n[e.jobTitle]||n.Default));var s=n[e.jobTitle]||n.Default;o+=s/1950*t})),o.toFixed(2)}(e,o);a="Total cost of the meeting: $".concat(s),c="meetingcost",console.log("Displaying infobar: "+a),Office.context.mailbox.item.notificationMessages.addAsync(c,{type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:a,icon:"Icon.16x16",persistent:!0},(function(e){e.status===Office.AsyncResultStatus.Failed&&(console.error("Failed to add infobar, try to replace instead: "+e.error.message),Office.context.mailbox.item.notificationMessages.replaceAsync(c,{type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:a,icon:"Icon.16x16",persistent:!0},(function(e){e.status===Office.AsyncResultStatus.Failed&&console.error("Failed to replace infobar: "+e.error.message)})))})),t.asyncContext.completed({allowEvent:!1})}else console.error("Failed to get HTML body."),t.asyncContext.completed({allowEvent:!1});var a,c},Office.context.mailbox.getCallbackTokenAsync({isRest:!0},(function(e){if(e.status===Office.AsyncResultStatus.Succeeded){var t=[],o=s.length;s.forEach((function(e){Office.context.mailbox.makeEwsRequestAsync('<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages" xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n                        <soap:Header>\n                            <t:RequestServerVersion Version="Exchange2013" />\n                        </soap:Header>\n                        <soap:Body>\n                            <m:ResolveNames ReturnFullContactData="true" SearchScope="ActiveDirectory">\n                                <m:UnresolvedEntry>'.concat(e,"</m:UnresolvedEntry>\n                            </m:ResolveNames>\n                        </soap:Body>\n                    </soap:Envelope>"),(function(n){if(n.status===Office.AsyncResultStatus.Succeeded){var s,c=null===(s=(new DOMParser).parseFromString(n.value,"text/xml").getElementsByTagName("t:JobTitle")[0])||void 0===s?void 0:s.textContent;c?t.push({email:e,jobTitle:c}):t.push({email:e,jobTitle:"Not found"})}else t.push({email:e,jobTitle:"Request failed"});0==--o&&a(t)}))}))}else console.error("Failed to get callback token:"+e.error.code+" "+e.error.name+" "+e.error.message),a(null)}))):(console.error("Failed to get attendees."),t.asyncContext.completed({allowEvent:!1}))},a=[],e.requiredAttendees.getAsync((function(t){t.status===Office.AsyncResultStatus.Succeeded?(a=t.value.map((function(e){return e.emailAddress})),e.optionalAttendees.getAsync((function(e){e.status===Office.AsyncResultStatus.Succeeded?function(e,t){var o=[],n=e.length;e.forEach((function(e){if(e.includes("_"))return o.includes(e)||o.push(e),void(0==--n&&t(o));Office.context.mailbox.makeEwsRequestAsync('<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages" xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n                <soap:Header>\n                    <t:RequestServerVersion Version="Exchange2013" />\n                </soap:Header>\n                <soap:Body>\n                    <m:ExpandDL>\n                        <m:Mailbox>\n                            <t:EmailAddress>'.concat(e,"</t:EmailAddress>\n                        </m:Mailbox>\n                    </m:ExpandDL>\n                </soap:Body>\n            </soap:Envelope>"),(function(s){if(s.status===Office.AsyncResultStatus.Succeeded){var a=(new DOMParser).parseFromString(s.value,"text/xml").getElementsByTagName("t:Mailbox");if(0===a.length)o.includes(e)||o.push(e);else for(var c=0;c<a.length;c++){var i=a[c].getElementsByTagName("t:EmailAddress")[0].textContent;o.includes(i)||o.push(i)}}else console.error("Failed to expand distribution list: "+e),o.push(e);0==--n&&(console.log(o),t(o))}))}))}(a=a.concat(e.value.map((function(e){return e.emailAddress}))),s):(console.error("Failed to get optional attendees."),s(null))}))):(console.error("Failed to get required attendees."),s(null))}))},s=e.start,a=e.end,s.getAsync((function(e){e.status===Office.AsyncResultStatus.Succeeded?a.getAsync((function(t){if(t.status===Office.AsyncResultStatus.Succeeded){var n=new Date(e.value),s=new Date(t.value);o((s-n)/36e5)}else console.error("Failed to get end time."),o(null)})):(console.error("Failed to get start time."),o(null))})))}))}Office.onReady((function(){e=Office.context.mailbox.item})),Office.actions.associate("insertPoints",s),Office.actions.associate("attendeeChanged",(function(e){console.log("Event: ".concat(e.type)),s(null)})),Office.actions.associate("durationChanged",(function(e){console.log("Event: ".concat(e.type)),s(null)}))}();
//# sourceMappingURL=commands.js.map